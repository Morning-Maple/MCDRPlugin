# 多子服控制插件
### Multi Server Control
____
####  背景
服务器资源有限，但是又想多开几个服务器，且希望能通过一个主要的服务器（生存）来控制其他子服务器（比如镜像，创造，小游戏等等），直接通过主服开停，方便操作，因此参考其他插件自己搓了一个将就着用....
____
####  适用范围
**！！！本插件只适用于*MCDR类服务器*，以下提到的服务器均默认为*MCDR类服务器* ！！！**
____
####  依赖
`mcdreforged>=2.12.3`
____
##### 介绍
本插件用于一个服务器控制多个其他服务器（要求主控和被控均在一台设备上且版本一致，只要你客户端能进这些服务器，就算他们是版本一致）。

插件不会帮助你直接搭建子服务器，在使用本插件前，你需要自行准备好至少2个服务器，然后选取其中作为主服务，另一个作为子服，并把插件置于主服务器的插件文件夹内。

插件是为本人自己搭建的服务器定制的，如果不能满足你的需求，你可以把源码拉到你的本地，自行修改。
#####  命令介绍
```text
!!msc                       - 命令前缀
!!msc help                  - 命令帮助
!!msc list                  - 可选服务器列表
!!msc reload                - 刷新配置文件
!!msc <server_name> sync    - 对目标服务器与主服进行同步
!!msc <server_name> start   - 启动目标服务器
!!msc <server_name> stop    - 关闭目标服务器
!!msc <server_name> show    - 查看目标服务器信息
!!msc <server_name> status  - 查看目标服务器状态（正在运行/已关闭）
```
#####   插件配置
下面就一起来配置插件吧！

首先你需要在主服中加载该插件，然后到config文件夹内寻找`MultiServerControl.json`文件，里面已经写好了一些例子，打开它：

下面是各个键值对的说明：
>`server_list`：一个列表，存储你所有子服务器的名字

>`perm`：一个键值对，表示每个命令的最低执行权限，如果你考虑权限问题，全部设置为 **0** 即可

>`mirror`和`create`：子服务器名字，只接受[a-z][a-z0-9]，也就是开头必须是小写字母，后面可以小写字母或者数字
> 
> `can_sync`：是否允许同步操作（开启后允许把主服的地图同步到子服中）
> 
> `description`：此子服的描述
> 
> `port`：子服务器占用的端口（用于检测子服情况）
> 
> `rcon`：Rcon相关
> >
> > `enable`：是否启用Rcon（不启用则无法通过主服关闭子服）
> >
> > `host`：子服务器地址
> >
> > `port`：子服务器的Rcon端口号
> >
> > `password`：子服务器的Rcon的密码
> 
> `source`：主服的server文件夹地址，一般都是`./server`
> 
> `target`：子服的server文件夹地址，一般都是`./子服务器名字（首字母大写）/server`
> 
> `ignore_files`：复制时忽略的文件名字，没其他要求直接用例子给的就行，`session.lock`文件默认忽略


我们按上面的例子，在MCDR根目录下创建2个子服务器的文件夹，分别是`Create`和`Mirror`，为什么文件夹必须大写？嗯，因为设计的时候想方便找...:
```tree
MCDR
├─config（初始可能没有）
├─Create（创造子服）
├─log
├─Mirror（镜像子服）
├─plugins
├─server
├─config.yml
└─permission.yml
```
然后把`Create`和`Mirror`这俩子服务器的相关配置内容填入到`config`下的`MultiServerControl.json`即可！

#####   TODO:
- [ ] 增加restart功能（重启服务器）
- [ ] 完善服务器文本提示（写了suggest但是实际上没反馈...待研究）
- [ ] 为部分命令的文本输出添加执行者
- [ ] 增加一个日志，用于查看命令使用情况（谁什么时间执行了什么命令结果怎么样），并允许配置文件中调整记录级别
